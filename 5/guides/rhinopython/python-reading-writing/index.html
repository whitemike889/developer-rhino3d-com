<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>How to read and write a simple file with Python</title>
  <meta name="description" content="Use Python to read and write files.  Using Python">

  <!-- OpenGraph for Facebook, Twitter, Slack unfurling -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/guides/rhinopython/python-reading-writing/" />
  <meta property="og:title" content="How to read and write a simple file" />
  <meta property="og:description" content="Use Python to read and write files." />
  <meta property=”og:site_name” content="developer.rhino3d.com"/>
  <meta property=”og:image” content="http://developer.rhino3d.com/images/rhinodev-logo-unfurl.png"/>

  <!-- twitter card tags additive with the og: tags -->
  <meta name="twitter:domain" value="developer.rhino3d.com" />
  <meta name="twitter:title" value="How to read and write a simple file" />
  <meta name="twitter:description" value="Use Python to read and write files." />
  
    <meta name="twitter:image" content="http://developer.rhino3d.com/images/rhinodev-logo-unfurl.png" />
  
  <meta name="twitter:url" value="http://developer.rhino3d.com" />
  
  <meta name="twitter:label1" value="Platform(s)" />
  <meta name="twitter:data1" value="Mac, Windows" />
  
  
  <meta name="twitter:label2" value="Language(s)" />
  <meta name="twitter:data2" value="Python" />
  

  <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/vbnet.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
  <script src="/5/node_modules/highlightjs-line-numbers.js/dist/highlightjs-line-numbers.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script>hljs.initLineNumbersOnLoad();</script>

  <!-- Overridden theme -->
  <link rel="stylesheet" href="/5/css/main.css">

  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">
  <!-- Bootstrap override -->
  <link rel="stylesheet" href="/5/css/bootstrap-override.css">

  <link rel="canonical" href="http://developer.rhino3d.com/5/guides/rhinopython/python-reading-writing/">
  <link rel="alternate" type="application/rss+xml" title="Rhino Developer Docs" href="http://developer.rhino3d.com/5/feed.xml" />

  <link rel="shortcut icon" href="http://developer.rhino3d.com/favicon.ico?v=2" />
  <!-- Saving bookmarks to mobile devices -->
  <!-- For non-Retina (@1× display) iPhone, iPod Touch, and Android 2.1+ devices: -->
  <link rel="apple-touch-icon-precomposed" href="/5/images/apple-touch-icon-precomposed.png"><!-- 57×57px -->
  <!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/5/images/apple-touch-icon-72x72-precomposed.png">
  <!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/5/images/apple-touch-icon-76x76-precomposed.png">
  <!-- For iPhone with @2× display running iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/5/images/apple-touch-icon-114x114-precomposed.png">
  <!-- For iPhone with @2× display running iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/5/images/apple-touch-icon-120x120-precomposed.png">
  <!-- For iPad with @2× display running iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/5/images/apple-touch-icon-144x144-precomposed.png">
  <!-- For iPad with @2× display running iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/5/images/apple-touch-icon-152x152-precomposed.png">
  <!-- For iPhone 6 Plus with @3× display: -->
  <link rel="apple-touch-icon-precomposed" sizes="180x180" href="/5/images/apple-touch-icon-180x180-precomposed.png">
  <!-- For Chrome for Android: -->
  <link rel="icon" sizes="192x192" href="images/touch-icon-192x192.png">

  <!-- Diable crawling until this version is the stable version -->
  <meta name="robots" content="noindex" />

</head>


  <body>

    <!-- Google Tag Manager **This belongs right after the <body> tag**-->
    <noscript>
        <iframe src="//www.googletagmanager.com/ns.html?id=GTM-MWMDKN"
        height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <script>
        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-MWMDKN');
    </script>
    <!-- End Google Tag Manager -->


    



  <!-- The following are "casts" from the string to number using math filters... -->
  
  

  <!-- ...but we need to check to see if the original branches were numbers or not... -->
  
  

  
  
  
  

  <!--  -->
    <div class="version-banner">
        Hey, you're viewing the <strong>Rhino 5</strong> version of this page!
        
          
            <a href="/guides/rhinopython/python-reading-writing/">View the <strong>Rhino 6</strong> version instead.</a>
          
          
          
        
    </div>

    <!-- Check the version banner for broken links and remove the link if found -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script>
    $(document).ready(function()
    {
      var splitPath = window.location.pathname.split("/");
      var nonWipURL = "/" + splitPath.splice(2,splitPath.length-2).join("/");

      $.get(nonWipURL).fail(function ()
      {
        var $aTag = $("div.version-banner > a");
        $aTag.text("View the current site instead.");
        $aTag.attr("href", "/");
      });
    });
    </script>
  <!--  -->




    <div class="container">

      <header class="site-header">


    <a class="site-title" href="/5/"><img src="/5/images/rhinodevlogo148x128.png" alt="Rhino Developer Docs" height="48" width="56"></a><a class="site-title" href="/5/">Rhino Developer Docs</a>

    <nav class="site-nav">
      <img class="menu-icon" src="/5/images/gi.svg">
      
      <div class="trigger">
      	<!--<a class="page-link" href="/5/">Welcome</a>-->
        <!-- get current page title and "collection" to figure out which nav
             link should be "active" -->
        
        
        
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
        
          
            
              
                
                  <a class="page-link active" href="/5/guides/">Guides</a>
                
              
            
          
        
          
            
              
                
                  <a class="page-link" href="/5/api/">API</a>
                
              
            
          
        
          
            
              
                
                  <a class="page-link" href="/5/samples/">Samples</a>
                
              
            
          
        
          
            
          
        
          
            
              
                
                  <a class="page-link" href="/5/videos/">Videos</a>
                
              
            
          
        
        <a class="page-link" href="http://discourse.mcneel.com/c/rhino-developer">Forums</a>
        <!-- Google Search Engine -->
        <!-- TODO Move to this site back into the Mcneel search, or use a simple site only search for results -->
        <div id="sitesearch">
            <!-- Google CSE Search Box Begins  -->
            <!-- Use of this code assumes agreement with the Google Custom Search Terms of Service. -->
            <!-- The terms of service are available at https://www.google.com/cse/docs/tos.html -->
            <form id="cref" action="/5/search-results.html">
                <input type="hidden" name="cref" value="007988927381198593803:mcq6pshqsn8" />
                <input id="searchtext" type="text" name="q" size="24" value="" placeholder="search" />
                <input class="searchBox" type="submit" name="sa" size="2" value=" " />
            </form>
        <!-- Google CSE Search Box Ends -->
        </div>
        <!--End of Google Search Engine -->
      </div>
    </nav>

</header>


      <div class="page-content">
        <!--div class="wrapper"-->
          <div class="container-fluid">

<div class="row-fluid">
    <!--Nav Bar -->
    <nav class="col-xs-0 col-md-3 bs-docs-sidebar">
    <ul id="sidebar" class="nav nav-stacked fixed">
        <!-- Find the h2 group and any h3 subgroups -->
        

        
          

          
            
            
            
            
            <li>
              <a href="#reading-a-file">Reading a file</a>

              

            </li>
          

        
          

          
            
            
            
            
            <li>
              <a href="#writing-a-file">Writing a file</a>

              

            </li>
          

        
    </ul>
</nav>


    <!--Main Content -->
    <div class="col-xs-12 col-md-9">
      <!--<div class="post">-->

        <article class="post-content">

          <ol class="breadcrumb">
              
              
              
              <li><a href="/5/guides/rhinopython">RhinoPython</a></li>

              
                
                  <li class="active">Intermediate</li>
                
              
          </ol>

          <h1>How to read and write a simple file</h1>

          <p>
  <span class="guide_byline">
    
      
      
        by <a href="https://discourse.mcneel.com/users/scottd/activity">Scott Davidson</a>
      
    
  </span>

</p>

          <p>Use Python to read and write files.</p>

          <p>We’ll use a couple of simple scripts from the Python Samples folder as examples - we’ll dissect these to see how they work.</p>

<h2 id="reading-a-file">Reading a file</h2>

<p>Here is the import-points.py script</p>

<pre><code class="language-python"># Import points from a text file
import rhinoscriptsyntax as rs

def ImportPoints():
    #prompt the user for a file to import
    filter = "Text file (*.txt)|*.txt|All Files (*.*)|*.*||"
    filename = rs.OpenFileName("Open Point File", filter)
    if not filename: return

    #read each line from the file
    file = open(filename, "r")
    contents = file.readlines()
    file.close()

    # local helper function    
    def __point_from_string(text):
        items = text.strip("()\n").split(",")
        x = float(items[0])
        y = float(items[1])
        z = float(items[2])
        return x, y, z

    contents = [__point_from_string(line) for line in contents]
    rs.AddPoints(contents)


##########################################################################
# Check to see if this file is being executed as the "main" python
# script instead of being used as a module by some other python script
# This allows us to use the module which ever way we want.
if( __name__ == "__main__" ):
    ImportPoints()
</code></pre>
<hr />

<p>We’ve put the action inside a function in this script, the</p>

<pre><code class="language-python">def ImportPoints()
</code></pre>
<p>section. This allows the code to be re-used and simplifies error checking.
The first part uses the rs function</p>

<pre><code class="language-python">rs.OpenFileName()
</code></pre>

<p>to allow the user to specify a file to open, and sets a variable ‘filename’ to hold this information:</p>

<pre><code class="language-python">filename = rs.OpenFileName("Open Point File", filter)
</code></pre>

<p>with a filter for text files.</p>

<p>If for some reason the user does not specify a file, say with a Cancel, then the line</p>

<pre><code class="language-python">if not filename: return
</code></pre>

<p>ensures that the rest of the code inside this particular function will not be run, since there is nothing that can be done without a file name, and executing the next lines in the script will result in error messages without it. Since there is only the one function in this script, a cancel means the script will stop.</p>

<p>Next a variable is set to the open file for reading:</p>

<pre><code class="language-python">file = open(filename, "r")
</code></pre>

<p>and a variable is set to the contents of the file  which is then held in memory as a list with one item per line:</p>

<pre><code class="language-python">contents = file.readlines()
</code></pre>

<p>The file is then closed:</p>

<pre><code>python file.close()
</code></pre>

<p>See python documentation for other ways to read files (<a href="https://docs.python.org/2/tutorial/inputoutput.html#reading-and-writing-files">https://docs.python.org/2/tutorial/inputoutput.html#reading-and-writing-files</a>).</p>

<p>At this point in the script, a new function is added, called <em>__point_from_string(text)</em> ,  inside the main function, that parses text in the expected format and converts the text into three numbers and returns those as the xy,z coordinates of a point.</p>

<p>The list of lines from the orignal text file is fed into this function, line by line to create a list of points, by calling that function:</p>

<pre><code class="language-python">contents = [__point_from_string(line) for line in contents]
</code></pre>

<p>Lastly, the points in the list are added to the Rhino document as point objects:</p>

<pre><code class="language-python">rs.AddPoints(contents)
</code></pre>

<p>Note all if this code will not actually run unless the function is called - this is done from the very last line of the script:</p>

<pre><code class="language-python">if( __name__ == "__main__" ):
    ImportPoints()
</code></pre>

<h2 id="writing-a-file">Writing a file</h2>

<p>Writing a file is similar to reading, but the order in which things are done is different. This time we’ll look at the ExportPoints.py sample file.</p>

<pre><code class="language-python">import rhinoscriptsyntax as rs

#Get the points to export
objectIds = rs.GetObjects("Select Points",1+2, True, True)
if( objectIds==None ): return

#Get the filename to create
filter = "Text File (*.txt)|*.txt|All Files (*.*)|*.*||"
filename = rs.SaveFileName("Save point coordinates as", filter)
if( filename==None ): return


with open(filename, "w") as file:
     # treat the objects differently depending on whether they are points or point clouds
    for id in objectIds:
        #process point clouds
        if( rs.IsPointCloud(id) ):
        points = rs.PointCloudPoints(id)
        for pt in points:
            file.write(str(pt)+"\n")
        elif( rs.IsPoint(id) ):
        point = rs.PointCoordinates(id)
        file.write(str(point) + "\n")

</code></pre>
<hr />

<p>There are a couple of things to notice, compared to the previous example. We need some points to export, so we’ll let the user select some point objects and point clouds. There is a filter applied to the selection, the <em>1+2</em>. 1 filters for point objects and 2 filters for point clouds - we can add the filters together to make combinations such as we have here - 1+2 or, we could have written just 3, that would work as well, it is just harder to parse when reviewing or modifying the code:</p>

<pre><code class="language-python">objectIds = rs.GetObjects("Select Points", 1+2, True, True)
</code></pre>

<p>As before we check to make sure that the user has in fact selected the things we’re looking for.</p>

<pre><code class="language-python">if( objectIds==None ): return
</code></pre>

<p>Next we’ll get a file name as in the first example:</p>

<pre><code class="language-python">#Get the filename to create
filter = "Text File (*.txt)|*.txt|All Files (*.*)|*.*||"
filename = rs.SaveFileName("Save point coordinates as", filter)
if( filename==None ): return
</code></pre>

<p>When writing to a file it must first be <em>opened</em>.  While it is open, the information can be written to the file.  After writing all the information, the file must be closed. In the first example we explicitly opened, read and then closed the file. This time we’ve used the <em>with</em> statement to open the file - <em>with</em> is convenient because it takes care of closing the file and cleaning up when the script leaves the indented <em>with</em> section.</p>

<pre><code class="language-python">with open(filename, "w") as file:
     # treat the objects differently depending on whether they are points or point clouds
    for id in objectIds:
        #process point clouds
        if( rs.IsPointCloud(id) ):
        points = rs.PointCloudPoints(id)
        for pt in points:
            file.write(str(pt)+"\n")
        #process point objects
        elif( rs.IsPoint(id) ):
        point = rs.PointCoordinates(id)
        file.write(str(point) + "\n")
</code></pre>
<p>Keep in mind that ‘points’ in the script are not the same as ‘point objects’ in the Rhino file. Points are a list of x,y,z coordinates and point objects are objects in the Rhino file that have, among other properties like display color or layer, a location - the point coordinates.  As you can see in the above, the script iterates a list of IDs -those of the selected point objects or point clouds, and extracts the x,y,z coordinates to write to the file. The exported points are only the x,y,z coordinates of the point objects.</p>

<p>For more information on reading and writing from Python, see the <a href="https://docs.python.org/2/tutorial/inputoutput.html#methods-of-file-objects">Python Methods in File Objects documentation</a></p>

        </article>

      <!--</div>-->

    </div>
</div>
</div>

        <!--/div-->
      </div>

      <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">

      
        <div class="row">
          <div class="col-md-4">

            <p class="text">
              
                Author: <a href="https://discourse.mcneel.com/users/scottd/activity">Scott Davidson</a>
              
            </p>
          </div>
          <div class="col-md-4 text-center">
            <span class="icon  icon--github">
              <svg viewBox="0 0 16 16">
                <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <a href="https://github.com/mcneel/developer-rhino3d-com/blob/5/_guide_topics/rhinopython/python-reading-writing.md" target="_blank">Edit page on GitHub</a>
          </div>
            <div class="col-md-4">
              <span class="pull-right">
                <span class="glyphicon glyphicon-cog"></span>&nbsp;<a href="/5/admin">Admin</a>
              </span>
            </div>
        </div>

        <div class="row text-center">
          © 1997 - 2017 Robert McNeel &amp; Associates
        </div>

      

    </div>

  </div>

  <script>
    if (navigator.appVersion.indexOf("Win")!=-1)
    {
      var body = document.getElementsByTagName("body");
      body[0].style.fontWeight = '400';
    }
  </script>

</footer>

    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

    <!-- MathJax -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <script type="text/javascript">
    $('body').scrollspy({
        target: '.bs-docs-sidebar',
        offset: 150 /* fixed header is about 40px high */
    });
    </script>
    <!--
    Next block expands Bootstrap Collapse component when linked to it.  Used in rhinoscriptsyntax api docs
    ex: http://developer.rhino3d.com/api/RhinoScriptSyntax/win/#collapse-PointCompare
    -->
    <script type="text/javascript">
    $(document).ready(function () {
        if(document.title == 'rhinoscriptsyntax' && location.hash != null && location.hash != ""){
            $('.collapse').removeClass('in');
            $('#collapse-' + location.hash.split("-")[1] + '.collapse').collapse('show');
        }
    });
    </script>
  </body>

</html>
