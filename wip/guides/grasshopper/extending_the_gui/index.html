<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Extending the GUI with C#, VB</title>
  <meta name="description" content="This guide describes how to extend the default behaviour, functionality, and graphical user interface (GUI) of Grasshopper document objects.  Using C#, VB">

  <!-- OpenGraph for Facebook, Twitter, Slack unfurling -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/guides/grasshopper/extending_the_gui/" />
  <meta property="og:title" content="Extending the GUI" />
  <meta property="og:description" content="This guide describes how to extend the default behaviour, functionality, and graphical user interface (GUI) of Grasshopper document objects." />
  <meta property=”og:site_name” content="developer.rhino3d.com"/>
  <meta property=”og:image” content="/wip/images/rhinodev_logo_unfurl.png"/>

  <!-- twitter card tags additive with the og: tags -->
  <meta name="twitter:domain" value="developer.rhino3d.com" />
  <meta name="twitter:title" value="Extending the GUI" />
  <meta name="twitter:description" value="This guide describes how to extend the default behaviour, functionality, and graphical user interface (GUI) of Grasshopper document objects." />
  
    
      <meta name="twitter:image" content="/wip/images/grasshopper_logo_unfurl.png" />
    
  
  <meta name="twitter:url" value="http://developer.rhino3d.com" />
  
  <meta name="twitter:label1" value="Platform(s)" />
  <meta name="twitter:data1" value="Windows, Mac" />
  
  
  <meta name="twitter:label2" value="Language(s)" />
  <meta name="twitter:data2" value="C#, VB" />
  

  <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/github.min.css">
  <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/languages/vbnet.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <!-- Overridden theme -->
  <link rel="stylesheet" href="/wip/css/main.css">

  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">
  <!-- Bootstrap override -->
  <link rel="stylesheet" href="/wip/css/bootstrap-override.css">

  <link rel="canonical" href="http://developer.rhino3d.com/wip/guides/grasshopper/extending_the_gui/">
  <link rel="alternate" type="application/rss+xml" title="Rhino Developer Docs" href="http://developer.rhino3d.com/wip/feed.xml" />

  <link rel="shortcut icon" href="http://developer.rhino3d.com/favicon.ico?v=2" />
  <!-- Saving bookmarks to mobile devices -->
  <!-- For non-Retina (@1× display) iPhone, iPod Touch, and Android 2.1+ devices: -->
  <link rel="apple-touch-icon-precomposed" href="/wip/images/apple-touch-icon-precomposed.png"><!-- 57×57px -->
  <!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/wip/images/apple-touch-icon-72x72-precomposed.png">
  <!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/wip/images/apple-touch-icon-76x76-precomposed.png">
  <!-- For iPhone with @2× display running iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/wip/images/apple-touch-icon-114x114-precomposed.png">
  <!-- For iPhone with @2× display running iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/wip/images/apple-touch-icon-120x120-precomposed.png">
  <!-- For iPad with @2× display running iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/wip/images/apple-touch-icon-144x144-precomposed.png">
  <!-- For iPad with @2× display running iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/wip/images/apple-touch-icon-152x152-precomposed.png">
  <!-- For iPhone 6 Plus with @3× display: -->
  <link rel="apple-touch-icon-precomposed" sizes="180x180" href="/wip/images/apple-touch-icon-180x180-precomposed.png">
  <!-- For Chrome for Android: -->
  <link rel="icon" sizes="192x192" href="images/touch-icon-192x192.png">

  <!-- Diable crawling until this version is the stable version -->
  <meta name="robots" content="noindex" />
</head>


  <body>

    <!-- Google Tag Manager **This belongs right after the <body> tag**-->
    <noscript>
        <iframe src="//www.googletagmanager.com/ns.html?id=GTM-MWMDKN"
        height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <script>
        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-MWMDKN');
    </script>
    <!-- End Google Tag Manager -->


    
<div class="version-banner">
    Hey, you're viewing the <strong>wip</strong> version of this page!
    <a href="/guides/grasshopper/extending_the_gui/">View the current version instead.</a>
</div>

<!-- Check the version banner for broken links and remove the link if found -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script>
$(document).ready(function()
{
  var splitPath = window.location.pathname.split("/");
  var nonWipURL = "/" + splitPath.splice(2,splitPath.length-2).join("/");

  $.get(nonWipURL).fail(function ()
  {
    var $aTag = $("div.version-banner > a");
    $aTag.text("View the current site instead.");
    $aTag.attr("href", "/");
  });
});
</script>




    <div class="container">

      <header class="site-header">


    <a class="site-title" href="/wip/"><img src="/wip/images/rhinodevlogo148x128.png" alt="Rhino Developer Docs" height="48" width="56"></a><a class="site-title" href="/wip/">Rhino Developer Docs</a>

    <nav class="site-nav">
      <img class="menu-icon" src="/wip/images/gi.svg">
      
      <div class="trigger">
      	<!--<a class="page-link" href="/wip/">Welcome</a>-->
        <!-- get current page title and "collection" to figure out which nav
             link should be "active" -->
        
        
        
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
        
          
            
              
                
                  <a class="page-link active" href="/wip/guides/">Guides</a>
                
              
            
          
        
          
            
              
                
                  <a class="page-link" href="/wip/api/">API</a>
                
              
            
          
        
          
            
              
                
                  <a class="page-link" href="/wip/samples/">Samples</a>
                
              
            
          
        
          
            
          
        
          
            
              
                
                  <a class="page-link" href="/wip/videos/">Videos</a>
                
              
            
          
        
        <a class="page-link" href="http://discourse.mcneel.com/c/rhino-developer">Forums</a>
        <!-- Google Search Engine -->
        <!-- TODO Move to this site back into the Mcneel search, or use a simple site only search for results -->
        <div id="sitesearch">
            <!-- Google CSE Search Box Begins  -->
            <!-- Use of this code assumes agreement with the Google Custom Search Terms of Service. -->
            <!-- The terms of service are available at https://www.google.com/cse/docs/tos.html -->
            <form id="cref" action="/wip/search-results.html">
                <input type="hidden" name="cref" value="007988927381198593803:mcq6pshqsn8" />
                <input id="searchtext" type="text" name="q" size="24" value="" placeholder="search" />
                <input class="searchBox" type="submit" name="sa" size="2" value=" " />
            </form>
        <!-- Google CSE Search Box Ends -->
        </div>
        <!--End of Google Search Engine -->
      </div>
    </nav>

</header>


      <div class="page-content">
        <!--div class="wrapper"-->
          <div class="container-fluid">

<div class="row-fluid">
    <!--Nav Bar -->
    <nav class="col-xs-0 col-md-3 bs-docs-sidebar">
    <ul id="sidebar" class="nav nav-stacked fixed">

      <!-- Find the h1 handle and title -->
      <!-- 
      
      
      
      
      
      
      
      <li>
        <a href="#extending-the-gui">Extending the GUI</a>

        <ul class="nav nav-stacked"> -->
          <!-- Find the h2 group and any h3 subgroups -->
          

          
            

            
              
              
              
              
              <li>
                <a href="#default-functionality-and-gui">Default Functionality and...</a>

                

              </li>
            


          
            

            
              
              
              
              
              <li>
                <a href="#menus">Menus</a>

                

              </li>
            


          
            

            
              
              
              
              
              <li>
                <a href="#interaction">Interaction</a>

                

              </li>
            


          
            

            
              
              
              
              
              <li>
                <a href="#display">Display</a>

                

              </li>
            


          
            

            
              
              
              
              
              <li>
                <a href="#related-topics">Related Topics</a>

                

              </li>
            


          
        

        <!-- </ul>

      </li> -->

    </ul>
</nav>


    <!--Main Content -->
    <div class="col-xs-12 col-md-9">
      <!--<div class="post">-->

        <article class="post-content">
          <ol class="breadcrumb">
              
              
              
              <li><a href="/wip/guides/grasshopper">Grasshopper</a></li>
              
              <li class="active">Advanced</li>
              
          </ol>

          <h1 id="extending-the-gui">Extending the GUI</h1>

<p><span class="guide_byline">by <a href="https://discourse.mcneel.com/users/DavidRutten/activity">David Rutten</a></span></p>

<p>This guide describes how to extend the default behaviour, functionality, and graphical user interface (GUI) of Grasshopper document objects.</p>

<p>We’ll focus on components as you should be familiar with those from earlier topics, but the same logic also applies to Parameters and custom objects.</p>

<h2 id="default-functionality-and-gui">Default Functionality and GUI</h2>

<p>When you derive a class from <a href="/wip/api/grasshopper/html/T_Grasshopper_Kernel_GH_Component.htm">GH_Component</a> or <a href="/wip/api/grasshopper/html/T_Grasshopper_Kernel_GH_Param_1.htm">GH_Param(T)</a> you get a lot of functionality and GUI for free.  It is quite important that all the objects in Grasshopper behave in a consistent and predictable fashion so you typically don’t need to override this default behaviour.  However there can be cases where changing the default Grasshopper GUI is the best solution.  Overriding the GUI is not exactly a trivial task, there are a lot of different facets to this and I’ll discuss the most important ones in this topic.</p>

<p>There are three common ways in which the default GUI can be altered:</p>

<ul>
  <li><a href="#menus">Menus</a></li>
  <li><a href="#interaction">Interaction</a></li>
  <li><a href="#display">Display</a></li>
</ul>

<h2 id="menus">Menus</h2>

<p>It is possible to insert items into the default pop-up menus of objects, or even to completely alter the menu layout.  If your component for example can run in two different modes, you can choose to expose an additional GUI option instead of an input parameter.  These modes can then be toggled via the component pop-up menu.</p>

<p>At the lowest level, pop-up menus are generated by the canvas when a right mouse button click is detected over a component or parameter.  The menu by default contains no items and it is the responsibility of said component or parameter to populate the menu.  The top-level method which is in charge of this is <a href="/wip/api/grasshopper/html/M_Grasshopper_Kernel_IGH_DocumentObject_AppendMenuItems.htm">AppendMenuItems</a> which is defined inside <code>IGH_DocumentObject</code> and thus propagates to all objects on the canvas.</p>

<p>The <code>GH_DocumentObject</code> abstract class does not create any menu items, so unless this function is overridden, there will be no popup menu for a certain object.  However, it is unlikely you derive directly from <code>GH_DocumentObject</code> so this should not be a problem.  <code>GH_ActiveObject</code>, which is the base class for all objects on the canvas that actually do something (Sketches and Scribbles don’t “do” anything, hence they derive directly from <code>GH_DocumentObject</code>), does provide a default implementation of <code>AppendMenuItems()</code>.  The default layout of popup menus is:</p>

<ul>
  <li>NickName</li>
  <li>Preview</li>
  <li>Enabled</li>
  <li>Bake</li>
  <li>Warnings</li>
  <li>Errors</li>
  <li>Help</li>
</ul>

<p>Although if the object in question does not support previews or baking then those items will be missing from the final menu.  When overridden, <code>AppendMenuItems()</code> allows you to completely replace the default menu:</p>

<ul class="nav nav-pills">
  <li class="active"><a href="#cs" data-toggle="pill">C#</a></li>
  <li><a href="#vb" data-toggle="pill">VB.NET</a></li>
</ul>

<div class="tab-content">

  <pre class="tab-pane fade in active" id="cs"><code class="language-cs">public override bool AppendMenuItems(ToolStripDropDown menu)
{
  Menu_AppendGenericMenuItem(menu, "First item");
  Menu_AppendGenericMenuItem(menu, "Second item");
  Menu_AppendGenericMenuItem(menu, "Third item");
  Menu_AppendSeparator(menu);
  Menu_AppendGenericMenuItem(menu, "Fourth item");
  Menu_AppendGenericMenuItem(menu, "Fifth item");
  Menu_AppendGenericMenuItem(menu, "Sixth item");

  // Return true, otherwise the menu won't be shown.
  return true;
}
</code></pre>

  <pre class="tab-pane fade in" id="vb"><code class="language-vbnet">Public Overrides Function AppendMenuItems(ByVal menu As ToolStripDropDown) As Boolean
  Menu_AppendGenericMenuItem(menu, "First item")
  Menu_AppendGenericMenuItem(menu, "Second item")
  Menu_AppendGenericMenuItem(menu, "Third item")
  Menu_AppendSeparator(menu)
  Menu_AppendGenericMenuItem(menu, "Fourth item")
  Menu_AppendGenericMenuItem(menu, "Fifth item")
  Menu_AppendGenericMenuItem(menu, "Sixth item")

  'Return True, otherwise the menu won't be shown.
  Return True
End Function
</code></pre>

</div>

<p><img src="/wip/images/extending_the_gui_01.png" alt="AppendMenuItems" /></p>

<p>If you want to insert additional items into the menu it would be very annoying if you had to recreate this default menu layout from scratch every single time.  So even though you can override <code>AppendMenuItems()</code> it is recommended you instead override <code>AppendAdditionalMenuItems()</code> which allows you to insert custom menu items between Errors and Help without losing the standard functionality:</p>

<ul class="nav nav-pills">
  <li class="active"><a href="#cs1" data-toggle="pill">C#</a></li>
  <li><a href="#vb1" data-toggle="pill">VB.NET</a></li>
</ul>

<div class="tab-content">

  <pre class="tab-pane fade in active" id="cs1"><code class="language-cs">public override void AppendAdditionalMenuItems(ToolStripDropDown menu)
{
  base.AppendAdditionalMenuItems(menu);

  Menu_AppendGenericMenuItem(menu, "First item");
  Menu_AppendGenericMenuItem(menu, "Second item");
  Menu_AppendGenericMenuItem(menu, "Third item");
  Menu_AppendSeparator(menu);
  Menu_AppendGenericMenuItem(menu, "Fourth item");
  Menu_AppendGenericMenuItem(menu, "Fifth item");
  Menu_AppendGenericMenuItem(menu, "Sixth item");
}
</code></pre>

  <pre class="tab-pane fade in" id="vb1"><code class="language-vbnet">Public Overrides Sub AppendAdditionalMenuItems(ByVal menu As ToolStripDropDown)
  MyBase.AppendAdditionalMenuItems(menu)

  Menu_AppendGenericMenuItem(menu, "First item")
  Menu_AppendGenericMenuItem(menu, "Second item")
  Menu_AppendGenericMenuItem(menu, "Third item")
  Menu_AppendSeparator(menu)
  Menu_AppendGenericMenuItem(menu, "Fourth item")
  Menu_AppendGenericMenuItem(menu, "Fifth item")
  Menu_AppendGenericMenuItem(menu, "Sixth item")
End Sub
</code></pre>

</div>

<p><img src="/wip/images/extending_the_gui_02.png" alt="AppendAdditionalMenuItems" /></p>

<p><code>GH_Param&lt;T&gt;</code> for example derives from <code>GH_ActiveObject</code> and re-implements <code>AppendAdditionalMenuItems()</code> in order to supply the Wire Display, Disconnect, Reverse, Flatten and Graft menu items that are present in all parameters.  <code>GH_Component</code>, likewise, derives from <code>GH_ActiveObject</code> and it re-implements <code>AppendAdditionalMenuItems()</code> in order to insert the Shortest List, Longest List, Cross Reference and the parameter submenus.</p>

<p>Long story short; if you wish to insert additional menu items then either re-implement <code>AppendAdditionalMenuItems()</code> if you derive from <code>GH_Param&lt;T&gt;</code> or re-implement <code>AppendAdditionalComponentMenuItems()</code> if you derive from <code>GH_Component</code>:</p>

<ul class="nav nav-pills">
  <li class="active"><a href="#cs2" data-toggle="pill">C#</a></li>
  <li><a href="#vb2" data-toggle="pill">VB.NET</a></li>
</ul>

<div class="tab-content">

  <pre class="tab-pane fade in active" id="cs2"><code class="language-cs">// If you implement IGH_Param, then override this method. If you implement IGH_Component,
// then override AppendAdditionalComponentMenuItems instead.
protected override void AppendAdditionalMenuItems(ToolstripDropDown menu)
{  
  // Place a call to the base class to ensure the default parameter menu
  // is still there and operational.
  base.AppendAdditinalMenuItems(menu);

  // Now insert your own custom menu items.
  Menu_AppendGenericMenuItem(menu, "My Custom Menu Item", Menu_MyCustomItemClicked);
}

private void Menu_MyCustomItemClicked(Object sender, EventArgs e)
{
  Rhino.RhinoApp.WriteLine("Alcohol doesn't affect me...");
}
</code></pre>

  <pre class="tab-pane fade in" id="vb2"><code class="language-vbnet">'If you implement IGH_Param, then override this method. If you implement IGH_Component,
'then override AppendAdditionalComponentMenuItems instead.
Protected Overrides Sub AppendAdditionalMenuItems(ByVal menu As ToolstripDropDown)
  'Place a call to the base class to ensure the default parameter menu
  'is still there and operational.
  MyBase.AppendAdditinalMenuItems(menu)

  'Now insert your own custom menu items.
  Menu_AppendGenericMenuItem(menu, "My Custom Menu Item", Addressof Menu_MyCustomItemClicked)
End Sub

Private Sub Menu_MyCustomItemClicked(ByVal sender As Object, ByVal e As EventArgs)
  Rhino.RhinoApp.WriteLine("Alcohol doesn't affect me...")
End Sub
</code></pre>

</div>

<p>There’s a lot of menu utility functions provided by <code>GH_DocumentObject</code>.  They all start with “Menu_” and they’ll make it much easier to insert formatted menu items.  But of course nothing is stopping you from using typical <code>System.Windows.Forms</code> plumbing to extend the pop-up menu.</p>

<h2 id="interaction">Interaction</h2>

<p>You can also choose to handle specific mouse and keyboard events.  You could for example choose to respond to a mouse double-click event on your component.  Complicated objects such as Gradients and Graph Mappers handle all sorts of mouse events to provide grip-dragging functionality directly within the Grasshopper canvas.</p>

<h2 id="display">Display</h2>

<p>Finally, it is possible to override the way an object displays itself on the canvas.  These alterations can be minor, mere additions to the default display, or they can be radically different (as with the Gradient and Graph Mapper objects).  For a detailed explanation regarding display overrides, see the <a href="/wip/guides/grasshopper/custom_attributes">Custom Attributes</a> guide.</p>

<hr />

<h2 id="related-topics">Related Topics</h2>

<ul>
  <li><a href="/wip/guides/grasshopper/custom_attributes">Custom Attributes</a></li>
</ul>

        </article>

      <!--</div>-->

    </div>
</div>
</div>

        <!--/div-->
      </div>

      <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">

      
        <div class="row">
          <div class="col-md-4">

            <p class="text">
              
                Author: <a href="https://discourse.mcneel.com/users/DavidRutten/activity">David Rutten</a>
              
            </p>
          </div>
          <div class="col-md-4 text-center">
            <span class="icon  icon--github">
              <svg viewBox="0 0 16 16">
                <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <a href="https://github.com/mcneel/developer-rhino3d-com/blob/wip/_guide_topics/grasshopper/extending_the_gui.md" target="_blank">Edit page on GitHub</a>
          </div>
            <div class="col-md-4">
              <span class="pull-right">
                <span class="glyphicon glyphicon-cog"></span>&nbsp;<a href="/wip/admin">Admin</a>
              </span>
            </div>
        </div>

        <div class="row text-center">
          © 1997 - 2016 Robert McNeel &amp; Associates
        </div>

      

    </div>

  </div>

  <script>
    if (navigator.appVersion.indexOf("Win")!=-1)
    {
      var body = document.getElementsByTagName("body");
      body[0].style.fontWeight = '400';
    }
  </script>

</footer>

    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

    <!-- MathJax -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <script type="text/javascript">
    $('body').scrollspy({
        target: '.bs-docs-sidebar',
        offset: 150 /* fixed header is about 40px high */
    });
    </script>
  </body>

</html>
